<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movistar México | Portabilidad 5G & Equipos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Onest:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Onest', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .movistar-blue { background-color: #019DF0; }
        .text-movistar-blue { color: #019DF0; }
        .bg-movistar-green { background-color: #5BC500; }
        .stage-container { display: none; }
        .stage-container.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .app-icon { width: 24px; height: 24px; object-fit: contain; }
    </style>
</head>
<body>

    <header class="bg-white border-b sticky top-0 z-[100] shadow-sm">
        <div class="container mx-auto px-4 h-20 flex justify-between items-center">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/af/Movistar_logo.svg/1200px-Movistar_logo.svg.png" class="h-9 cursor-pointer" onclick="location.reload()">
            <div class="flex items-center gap-4 text-[11px] font-black uppercase text-slate-400 tracking-widest">
                <span class="flex items-center gap-2 text-movistar-green"><i class="fas fa-signal"></i> Red 5G Activa</span>
            </div>
        </div>
    </header>

    <section class="bg-gradient-to-br from-blue-700 to-sky-400 py-12 text-white">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-6xl font-black mb-4 italic tracking-tighter uppercase">Cámbiate a la nueva red 5G</h1>
            <p class="text-xl opacity-90 font-medium max-w-2xl mx-auto">Equipos al 40% de descuento, $0 enganche y Smartwatch de regalo al realizar tu portabilidad.</p>
        </div>
    </section>

    <section id="stage-1" class="stage-container active py-12">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-end mb-10">
                <h2 class="text-2xl font-black uppercase italic border-l-4 border-movistar-blue pl-4">Elige tu nuevo equipo</h2>
                <input type="text" id="search" onkeyup="filterDevices()" placeholder="Buscar modelo..." class="px-6 py-3 border rounded-full text-sm outline-none focus:border-movistar-blue w-64 shadow-sm">
            </div>
            
            <div id="device-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                </div>
        </div>
    </section>

    <section id="stage-2" class="stage-container py-12">
        <div class="container mx-auto max-w-6xl px-4">
            <div class="bg-white rounded-[3rem] shadow-2xl overflow-hidden grid grid-cols-1 lg:grid-cols-2 border">
                <div class="p-10 border-r bg-slate-50 flex flex-col items-center">
                    <img id="sel-img" src="" class="h-72 object-contain mb-6 drop-shadow-2xl">
                    <h3 id="sel-name" class="text-3xl font-black text-slate-800 text-center"></h3>
                    <div class="mt-4 flex gap-2" id="sel-specs"></div>
                    <div class="mt-8 bg-white p-6 rounded-3xl w-full border border-dashed border-blue-200">
                        <p class="text-xs font-black text-movistar-blue uppercase mb-2 text-center">Beneficios del Plan Seleccionado</p>
                        <div id="app-icons" class="flex flex-wrap justify-center gap-4 mb-4">
                            </div>
                        <ul id="plan-details" class="text-sm font-bold text-slate-500 space-y-2"></ul>
                    </div>
                </div>
                <div class="p-10">
                    <p class="text-[10px] font-black text-slate-400 uppercase mb-4">1. Elige tu Plan Mensual</p>
                    <div class="space-y-3 mb-8" id="plan-list"></div>

                    <p class="text-[10px] font-black text-slate-400 uppercase mb-4">2. Selecciona tu Sucursal de Entrega</p>
                    <select id="sucursal-select" class="w-full p-4 border rounded-2xl bg-white font-bold text-sm mb-8 outline-none focus:border-movistar-blue shadow-sm">
                        <option value="">Selecciona una sucursal...</option>
                        <optgroup label="AGUASCALIENTES">
                            <option>MOVISTAR PLAZA VELARIA MALL</option>
                            <option>MOVISTAR PLAZA VILLA ASUNCION</option>
                        </optgroup>
                        <optgroup label="CDMX / EDOMEX">
                            <option>MOVISTAR REFORMA 222</option>
                            <option>MOVISTAR PLAZA SATELITE</option>
                            <option>MOVISTAR PARQUE DELTA</option>
                        </optgroup>
                        <optgroup label="VERACRUZ">
                            <option>MOVISTAR VERACRUZ CENTRO</option>
                            <option>MOVISTAR POZA RICA</option>
                        </optgroup>
                        <optgroup label="YUCATÁN">
                            <option>MOVISTAR GRAN PLAZA MERIDA</option>
                        </optgroup>
                    </select>

                    <div class="bg-slate-900 text-white p-8 rounded-[2.5rem]">
                        <div class="flex justify-between text-xs font-black text-movistar-green uppercase mb-2">
                            <span>Total a pagar al mes</span>
                            <span>$0 Enganche</span>
                        </div>
                        <div class="text-5xl font-black tracking-tighter">$<span id="sel-total">0</span></div>
                        <p class="text-[10px] opacity-60 mt-4 font-bold uppercase tracking-widest">Requiere recarga inicial de $100 al activar</p>
                        <button onclick="navigateTo(3)" class="w-full bg-movistar-blue text-white py-5 rounded-2xl font-black uppercase text-sm mt-6 hover:scale-[1.02] transition shadow-lg">Continuar a Portabilidad</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="stage-3" class="stage-container py-12">
        <div class="max-w-xl mx-auto bg-white p-12 rounded-[3.5rem] shadow-2xl border">
            <h2 class="text-3xl font-black text-center mb-8 uppercase italic tracking-tighter">Tramita tu Portabilidad</h2>
            <form onsubmit="handleFinalSubmit(event)" class="space-y-4">
                <input type="text" id="cust-name" placeholder="Nombre completo" required class="w-full p-5 bg-slate-50 border rounded-2xl outline-none font-bold">
                <input type="tel" id="cust-phone" placeholder="Número actual (10 dígitos)" required maxlength="10" class="w-full p-5 bg-slate-50 border rounded-2xl outline-none font-bold">
                <div class="p-5 bg-blue-50 border border-blue-100 rounded-2xl text-[11px] font-bold text-blue-700 leading-relaxed uppercase">
                    <i class="fas fa-info-circle mr-2"></i> Recibirás un SMS con tu NIP de portabilidad para completar el trámite en sucursal.
                </div>
                <button class="w-full movistar-blue text-white py-6 rounded-3xl font-black uppercase text-sm shadow-xl shadow-blue-100 mt-6">Finalizar y enviar a WhatsApp</button>
            </form>
        </div>
    </section>

    <section id="stage-4" class="stage-container py-12 text-center px-4">
        <div class="max-w-md mx-auto bg-white p-16 rounded-[4rem] shadow-2xl border border-movistar-blue relative overflow-hidden">
            <div class="w-20 h-20 bg-movistar-green text-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl"><i class="fas fa-check text-3xl"></i></div>
            <h2 class="text-3xl font-black uppercase italic mb-2 tracking-tighter">¡Registro Exitoso!</h2>
            <p class="text-slate-400 font-bold text-xs uppercase mb-8 tracking-widest">Folio: <span id="folio-display" class="text-movistar-blue"></span></p>
            
            <div class="bg-slate-50 p-6 rounded-3xl mb-8">
                <p class="text-[10px] font-black text-slate-400 uppercase mb-2">Vigencia para acudir a sucursal:</p>
                <div class="text-4xl font-black text-slate-800 tracking-widest" id="countdown">72:00:00</div>
            </div>
            <p class="text-sm font-bold text-slate-500 leading-relaxed">
                Preséntate con tu identificación oficial y realiza una recarga de <span class="text-movistar-blue font-black">$100</span> para activar tu equipo y beneficios ilimitados.
            </p>
        </div>
    </section>

    <script>
        // Base de datos de equipos (simplificada aquí para el ejemplo, pero lista para los 50)
        const allDevices = [
            { id: 51, name: "iPhone 17 Pro Max", brand: "Apple", price: 32999, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/IPHONE/iPhone%2017%20Pro%20Max.jfif", specs: "A19 Pro | 512GB" },
            { id: 11, name: "Galaxy S24 Ultra", brand: "Samsung", price: 30999, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/SAMGMUG/s%2024%20ultra.jfif", specs: "Snapdragon 8 Gen 3" },
            { id: 23, name: "Razr 40 Ultra", brand: "Motorola", price: 26999, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/MOTOROLA/Razr%2040%20Ultra.jfif", specs: "6.9\" Foldable" },
            // ... (Se llenará automáticamente)
        ];

        const plans = [
            { id: 1, name: "PLAN MOVISTAR ILIMITADO PLUS", price: 449, apps: ['fb','wa','ig','tk','nf','yt'], details: ['GB Ilimitados', 'Llamadas Sin Límites', 'Hotspot Permitido'] },
            { id: 2, name: "PLAN MOVISTAR CONTROL 250", price: 250, apps: ['fb','wa','ig','tk'], details: ['20GB Libres', 'RRSS Ilimitadas', 'Llamadas Ilimitadas'] }
        ];

        let state = { dev: null, pl: plans[0], sucursal: '' };

        function renderDevices(filter = "") {
            const grid = document.getElementById('device-grid');
            grid.innerHTML = allDevices.map(d => `
                <div onclick="selectDev(${d.id})" class="bg-white p-4 rounded-[2rem] border hover:border-movistar-blue transition-all cursor-pointer group shadow-sm text-center">
                    <img src="${d.img}" class="h-32 mx-auto object-contain mb-4 group-hover:scale-110 transition-transform">
                    <h4 class="text-[11px] font-black text-slate-800 uppercase line-clamp-1">${d.name}</h4>
                    <p class="text-movistar-blue font-black text-sm">$${Math.floor(d.price * 0.6 / 24).toLocaleString()} / mes</p>
                    <p class="text-[8px] text-slate-400 font-bold uppercase mt-1">40% OFF + Regalo</p>
                </div>
            `).join('');
        }

        function selectDev(id) {
            state.dev = allDevices.find(d => d.id === id);
            updateSummary();
            navigateTo(2);
        }

        function updateSummary() {
            const cuotaEq = (state.dev.price * 0.6) / 24;
            const total = Math.floor(cuotaEq + state.pl.price);
            
            document.getElementById('sel-img').src = state.dev.img;
            document.getElementById('sel-name').innerText = state.dev.name;
            document.getElementById('sel-total').innerText = total.toLocaleString();
            
            // Iconos de apps según el plan
            const appIconsMap = {
                fb: 'https://cdn-icons-png.flaticon.com/512/733/733547.png',
                wa: 'https://cdn-icons-png.flaticon.com/512/733/733585.png',
                ig: 'https://cdn-icons-png.flaticon.com/512/2111/2111463.png',
                tk: 'https://cdn-icons-png.flaticon.com/512/3046/3046121.png',
                nf: 'https://cdn-icons-png.flaticon.com/512/732/732228.png',
                yt: 'https://cdn-icons-png.flaticon.com/512/1384/1384060.png'
            };
            
            document.getElementById('app-icons').innerHTML = state.pl.apps.map(a => `<img src="${appIconsMap[a]}" class="app-icon">`).join('');
            document.getElementById('plan-details').innerHTML = state.pl.details.map(d => `<li><i class="fas fa-check-circle text-movistar-green mr-2"></i> ${d}</li>`).join('');
            
            document.getElementById('plan-list').innerHTML = plans.map(p => `
                <div onclick="setPlan(${p.id})" class="p-4 border-2 rounded-2xl cursor-pointer transition-all flex justify-between items-center ${state.pl.id === p.id ? 'border-movistar-blue bg-blue-50' : 'border-slate-100'}">
                    <p class="font-black text-xs uppercase">${p.name}</p>
                    <p class="font-black text-movistar-blue">$${p.price}</p>
                </div>
            `).join('');
        }

        function setPlan(id) {
            state.pl = plans.find(p => p.id === id);
            updateSummary();
        }

        function handleFinalSubmit(e) {
            e.preventDefault();
            const folio = `MX5G-${Math.floor(100000 + Math.random() * 900000)}`;
            const suc = document.getElementById('sucursal-select').value;
            const name = document.getElementById('cust-name').value;
            const phone = document.getElementById('cust-phone').value;

            if(!suc) { alert("Por favor selecciona una sucursal"); return; }

            // Redirección WhatsApp
            const msg = `HOLA MOVISTAR. Deseo tramitar mi PORTABILIDAD.%0A%0A*FOLIO:* ${folio}%0A*CLIENTE:* ${name}%0A*TELÉFONO:* ${phone}%0A*EQUIPO:* ${state.dev.name}%0A*PLAN:* ${state.pl.name}%0A*SUCURSAL:* ${suc}%0A%0A*Nota:* El cliente acudirá en menos de 72h para su recarga de $100.`;
            
            window.open(`https://api.whatsapp.com/send?phone=04124676073&text=${msg}`, '_blank');
            
            document.getElementById('folio-display').innerText = folio;
            startCountdown();
            navigateTo(4);
        }

        function startCountdown() {
            let time = 72 * 3600;
            const display = document.getElementById('countdown');
            setInterval(() => {
                let h = Math.floor(time / 3600);
                let m = Math.floor((time % 3600) / 60);
                let s = time % 60;
                display.innerText = `${h < 10 ? '0'+h : h}:${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                if(time > 0) time--;
            }, 1000);
        }

        function navigateTo(s) {
            document.querySelectorAll('.stage-container').forEach(c => c.classList.remove('active'));
            document.getElementById(`stage-${s}`).classList.add('active');
            window.scrollTo(0,0);
        }

        window.onload = () => renderDevices();
    </script>
</body>
</html>
